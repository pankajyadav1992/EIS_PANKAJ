@model System.Data.DataTable
@using System.Data;

@section CustomStyles{
    @Styles.Render("~/Content/datatable")
    <style>
        #overlay {
            position: absolute;
            justify-content: left;
            z-index: 1000;
            top: 0;
            left: 0;
            height: 100%;
            width: 100%;
            background: rgba(130, 130, 130, 0.5);
        }
    </style>
}
@section Reports{
    show
}

@{ string headerClass = "";
    string type = "";}

@switch (ViewBag.Title)
{
    case "Active Employees Report":
        headerClass = "bg-success"; type = "Active";
        @section ActiveEmployees{
            class="active"
        }
        break;
    case "InActive Employees Report":
        headerClass = "bg-danger"; type = "InActive";
        @section InActiveEmployees{
            class="active"
        }
        break;
    case "All Employees Report":
        headerClass = "bg-info"; type = "All";
        @section AllEmployees{
            class="active"
        }
        break;
}

<div id="overlay" style="text-align:center;">
    <img src="~/Content/img/spinner.gif" style="resize:inherit;" />
    <br />
</div>
<!-- Page Header-->
<header class="page-header @headerClass text-white">
    <div class="container-fluid">
        <h2 class="no-margin-bottom">Report - @type Employees</h2>
    </div>
</header>
<!-- Forms Section-->
<section class="forms">
    <div class="container-fluid" style="position:relative">
        <div class="container-fluid">
            <div class="row">
                <div class="col-lg-12">
                    <div class="card">
                        <div class="card-header d-flex align-items-center">
                            <h3 class="h4">Report</h3>
                        </div>
                        <div class="card-body">
                            <table id="reportTable" class="table table-striped table-bordered" style="width:100%">
                                <thead>
                                    <tr>
                                        @foreach (DataColumn col in Model.Columns)
                                        {
                                            <th>@col.ColumnName</th>

                                        }
                                    </tr>
                                </thead>
                                <tbody>
                                    @foreach (DataRow row in Model.Rows)
                                    {
                                        <tr>
                                            @foreach (DataColumn col in Model.Columns)
                                            {
                                                <td class="tableRow">@row[col.ColumnName]</td>

                                            }
                                        </tr>

                                    }
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>
@section Scripts{
    @Scripts.Render("~/bundles/datatable")

<script>
        $('#overlay').fadeIn();
        $(document).ready(function () {

            // Add new-line BR to each column having multiple entries
            $(".tableRow").each(function () {
                oldhtml = $(this).html();
                var newhtml = oldhtml.replace(/NUMBER/g, "</br>");
                $(this).html(newhtml);
            });

            // DataTable
            $('#reportTable').DataTable({
                "scrollX": true,
                "scrollY": "1000px",
                "scrollCollapse": true,
                "paging": false,
                dom: 'Bfrtip',
                buttons: [
                    'copyHtml5',
                    'csvHtml5',
                    'pdfHtml5',
                    {
                        extend: 'excelHtml5',
                        sheetName: 'Report - @type Employees',
                        title: null,
                        customize: function (xlsx) {
                            var sheet = xlsx.xl.worksheets['sheet1.xml'];
                            var col = $('col', sheet);
                            col.each(function () {
                                $(this).attr('width', 20);
                            });
                            $('row c', sheet).attr('s', '55');
                            $('row:eq(0) c', sheet).attr('s', '2');
                        }
                    }
                ]
            });

            $('#overlay').fadeOut();
        });
</script>
}